/*
MIT License

Copyright (c) 2020 Cristobal Miranda T.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
*/
#include <gtest/gtest.h>

extern "C" {
#include <block.h>
#include <block_frontier.h>
#include <block_topology.h>
#include <queries_state.h>
}

#include "block_wrapper.hpp"

#include <algorithm>
#include <iostream>
#include <random>
#include <vector>

using namespace std;

std::random_device rd;
std::mt19937 g(rd());

TEST(block_test, problematic_input_seq_1_test) {
  uint32_t tree_depth = 22;
  struct block *root_block = create_block();
  struct queries_state qs {};
  init_queries_state(&qs, tree_depth, 256, root_block);

  std::vector<std::pair<unsigned long, unsigned long>> pairs = {

      {2435942, 1822678}, {2462421, 1920115}, {2366760, 1595921},
      {2117488, 1141805}, {2113889, 1131953}, {2385134, 1624246},
      {2408969, 1678218}, {2335783, 1541134}, {2449482, 1876875},
      {2436055, 1823182}, {2474962, 1960901}, {2037784, 960877},
      {2436135, 1823442}, {2012038, 896833},  {2417018, 1717381},
      {2413589, 1701903}, {2462344, 1919937}, {2367773, 1597498},
      {2430360, 1788087}, {2437050, 1826803}, {2419887, 1736674},
      {2328978, 1531403}, {2196922, 1299801}, {2431635, 1794752},
      {2210236, 1323004}, {2444318, 1854880}, {2339694, 1546957},
  };

  int i = 0;
  for (const auto &pair : pairs) {
    int already_exists;
    insert_point(root_block, pair.first, pair.second, &qs, &already_exists);
    // printf("------current tree after inserting (%lu, %lu)------\n\n",
    // pair.first, pair.second); debug_print_block_rec(root_block);
    // printf("------            ------\n\n\n");
    ASSERT_EQ(debug_validate_block_rec(root_block), 0)
        << "failing at the " << i << "th pair (" << pair.first << ", "
        << pair.second << ")";
    i++;
  }

  finish_queries_state(&qs);
  free_rec_block(root_block);
}

TEST(block_test, test1) {
  uint32_t tree_depth = 3;
  struct block *root_block = create_block();
  struct queries_state *qs = new struct queries_state;
  init_queries_state(qs, tree_depth, MAX_NODES_IN_BLOCK, root_block);
  int already_exists;
  insert_point(root_block, 1, 1, qs, &already_exists);

  int found_point;
  has_point(root_block, 1, 1, qs, &found_point);
  ASSERT_EQ(1, found_point);

  finish_queries_state(qs);
  free_rec_block(root_block);
  delete qs;
}

TEST(block_test, test2) {
  uint32_t treedepth = 3;
  unsigned long side = 1 << treedepth;
  BlockWrapper b(treedepth);
  b.insert(0, 0);
  b.insert(0, 1);
  b.insert(1, 0);
  ASSERT_TRUE(b.has(0, 0)) << "Block does not have point 0, 0";
  ASSERT_TRUE(b.has(0, 1)) << "Block does not have point 0, 1";
  ASSERT_TRUE(b.has(1, 0)) << "Block does not have point 1, 0";
  for (unsigned long col = 0; col < side; col++) {
    for (unsigned long row = 0; row < side; row++) {
      if ((col == 0 && row == 0) || (col == 0 && row == 1) ||
          (col == 1 && row == 0)) {
        continue;
      }
      ASSERT_FALSE(b.has(col, row)) << "Block has point " << col << ", " << row;
    }
  }
  ASSERT_EQ(debug_validate_block_rec(b.b), 0);
}

template <typename T, size_t N> constexpr size_t countof(T (&)[N]) { return N; }

const string to_compare[] = {
    "100010001000",
    "100010001100",
    "1000110011001000",
    "1000110011001100",
    "110011001100110010001000",
    "110011001100110010001100",
    "1100110011001100110011001000",
    "1100110011001100110011001100",
    "1100110011101100110011001100",
    "1100110011111100110011001100",
    "1100110011111110110011001100",
    "1100110011111111110011001100",
    "1100110011111111110011101100",
    "1100110011111111110011111100",
    "1100110011111111110011111110",
    "1100110011111111110011111111",
    "11001110111111111000110011111111",
    "11001110111111111100110011111111",
    "110011111111111111001000110011111111",
    "110011111111111111001100110011111111",
    "1100111111111111110011001110111111111000",
    "1100111111111111110011001110111111111100",
    "11001111111111111100110011111111111111001000",
    "11001111111111111100110011111111111111001100",
    "11001111111111111110110011111111111111001100",
    "11001111111111111111110011111111111111001100",
    "11001111111111111111111011111111111111001100",
    "11001111111111111111111111111111111111001100",
    "11001111111111111111111111111111111111101100",
    "11001111111111111111111111111111111111111100",
    "11001111111111111111111111111111111111111110",
    "11001111111111111111111111111111111111111111",
    "1110111111111111111111111111111111111111111110001000",
    "1110111111111111111111111111111111111111111110001100",
    "11101111111111111111111111111111111111111111110011001000",
    "11101111111111111111111111111111111111111111110011001100",
    "1111111111111111111111111111111111111111111111001100110010001000",
    "1111111111111111111111111111111111111111111111001100110010001100",
    "11111111111111111111111111111111111111111111110011001100110011001000",
    "11111111111111111111111111111111111111111111110011001100110011001100",
    "11111111111111111111111111111111111111111111110011101100110011001100",
    "11111111111111111111111111111111111111111111110011111100110011001100",
    "11111111111111111111111111111111111111111111110011111110110011001100",
    "11111111111111111111111111111111111111111111110011111111110011001100",
    "11111111111111111111111111111111111111111111110011111111110011101100",
    "11111111111111111111111111111111111111111111110011111111110011111100",
    "11111111111111111111111111111111111111111111110011111111110011111110",
    "11111111111111111111111111111111111111111111110011111111110011111111",
    "111111111111111111111111111111111111111111111110111111111000110011111111",
    "111111111111111111111111111111111111111111111110111111111100110011111111",
    "11111111111111111111111111111111111111111111111111111111110010001100111111"
    "11",
    "11111111111111111111111111111111111111111111111111111111110011001100111111"
    "11",
    "11111111111111111111111111111111111111111111111111111111110011001110111111"
    "111000",
    "11111111111111111111111111111111111111111111111111111111110011001110111111"
    "111100",
    "11111111111111111111111111111111111111111111111111111111110011001111111111"
    "1111001000",
    "11111111111111111111111111111111111111111111111111111111110011001111111111"
    "1111001100",
    "11111111111111111111111111111111111111111111111111111111111011001111111111"
    "1111001100",
    "11111111111111111111111111111111111111111111111111111111111111001111111111"
    "1111001100",
    "11111111111111111111111111111111111111111111111111111111111111101111111111"
    "1111001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "1111001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "1111101100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "1111111100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "1111111110",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "1111111111",
};

TEST(block_test, fills_depth_3_test2) {
  uint32_t treedepth = 3;
  unsigned long side = 1 << treedepth;
  BlockWrapper b(treedepth);

  for (unsigned long col = 0; col < side; col++) {
    for (unsigned long row = 0; row < side; row++) {
      int i = col * side + row % side;
      b.insert(col, row);
      ASSERT_EQ(to_compare[i], b.getStringRep())
          << "failing at col=" << col << ", row=" << row;
    }
  }
  ASSERT_EQ(debug_validate_block_rec(b.b), 0);
}

TEST(block_test, fills_depth_3) {
  uint32_t treedepth = 3;
  unsigned long side = 1 << treedepth;
  BlockWrapper b(treedepth, 8);

  for (unsigned long col = 0; col < side; col++) {
    for (unsigned long row = 0; row < side; row++) {

      b.insert(col, row);

      for (unsigned long col_check = 0; col_check < col; col_check++) {
        for (unsigned long row_check = 0; row_check < row; row_check++) {
          ASSERT_TRUE(b.has(col_check, row_check))
              << "at (" << col << ", " << row << ") Must have point "
              << col_check << ", " << row_check;
        }
      }
      for (unsigned long row_check = 0; row_check <= row; row_check++) {
        ASSERT_TRUE(b.has(col, row_check))
            << "at (" << col << ", " << row << ") Must have point " << col
            << ", " << row_check;
      }
      for (unsigned long row_check = row + 1; row_check < side; row_check++) {
        ASSERT_FALSE(b.has(col, row_check))
            << "at (" << col << ", " << row << ") Must not have point " << col
            << ", " << row_check;
      }
      for (unsigned long col_check = col + 1; col_check < side; col_check++) {
        for (unsigned long row_check = 0; row_check < side; row_check++) {
          ASSERT_FALSE(b.has(col_check, row_check))
              << "at (" << col << ", " << row << ") Must not have point "
              << col_check << ", " << row_check;
        }
      }
    }
  }
  for (unsigned long col = 0; col < side; col++) {
    for (unsigned long row = 0; row < side; row++) {
      ASSERT_TRUE(b.has(col, row)) << "No point " << col << ", " << row;
    }
  }
  ASSERT_EQ(debug_validate_block_rec(b.b), 0);
}

string comp_d6[] = {
    "1000100010001000",
    "1000100010001100",
    "10001000110011001000",
    "10001000110011001100",
    "1000110011001100110010001000",
    "1000110011001100110010001100",
    "10001100110011001100110011001000",
    "10001100110011001100110011001100",
    "11001100110011001100110011001100100010001000",
    "11001100110011001100110011001100100010001100",
    "110011001100110011001100110011001000110011001000",
    "110011001100110011001100110011001000110011001100",
    "11001100110011001100110011001100110011001100110010001000",
    "11001100110011001100110011001100110011001100110010001100",
    "110011001100110011001100110011001100110011001100110011001000",
    "110011001100110011001100110011001100110011001100110011001100",
    "110011001100111011001100110011001100110011001100110011001100",
    "110011001100111111001100110011001100110011001100110011001100",
    "110011001100111111101100110011001100110011001100110011001100",
    "110011001100111111111100110011001100110011001100110011001100",
    "110011001100111111111100111011001100110011001100110011001100",
    "110011001100111111111100111111001100110011001100110011001100",
    "110011001100111111111100111111101100110011001100110011001100",
    "110011001100111111111100111111111100110011001100110011001100",
    "110011001100111111111100111111111100110011101100110011001100",
    "110011001100111111111100111111111100110011111100110011001100",
    "110011001100111111111100111111111100110011111110110011001100",
    "110011001100111111111100111111111100110011111111110011001100",
    "110011001100111111111100111111111100110011111111110011101100",
    "110011001100111111111100111111111100110011111111110011111100",
    "110011001100111111111100111111111100110011111111110011111110",
    "110011001100111111111100111111111100110011111111110011111111",
    "1100110011101111111110001100111111111100110011111111110011111111",
    "1100110011101111111111001100111111111100110011111111110011111111",
    "11001100111111111111110010001100111111111100110011111111110011111111",
    "11001100111111111111110011001100111111111100110011111111110011111111",
    "110011001111111111111100110011101111111110001100110011111111110011111111",
    "110011001111111111111100110011101111111111001100110011111111110011111111",
    "11001100111111111111110011001111111111111100100011001100111111111100111111"
    "11",
    "11001100111111111111110011001111111111111100110011001100111111111100111111"
    "11",
    "11001100111111111111110011001111111111111100110011001110111111111000110011"
    "111111",
    "11001100111111111111110011001111111111111100110011001110111111111100110011"
    "111111",
    "11001100111111111111110011001111111111111100110011001111111111111100100011"
    "0011111111",
    "11001100111111111111110011001111111111111100110011001111111111111100110011"
    "0011111111",
    "11001100111111111111110011001111111111111100110011001111111111111100110011"
    "10111111111000",
    "11001100111111111111110011001111111111111100110011001111111111111100110011"
    "10111111111100",
    "11001100111111111111110011001111111111111100110011001111111111111100110011"
    "111111111111001000",
    "11001100111111111111110011001111111111111100110011001111111111111100110011"
    "111111111111001100",
    "11001100111111111111111011001111111111111100110011001111111111111100110011"
    "111111111111001100",
    "11001100111111111111111111001111111111111100110011001111111111111100110011"
    "111111111111001100",
    "11001100111111111111111111101111111111111100110011001111111111111100110011"
    "111111111111001100",
    "11001100111111111111111111111111111111111100110011001111111111111100110011"
    "111111111111001100",
    "11001100111111111111111111111111111111111110110011001111111111111100110011"
    "111111111111001100",
    "11001100111111111111111111111111111111111111110011001111111111111100110011"
    "111111111111001100",
    "11001100111111111111111111111111111111111111111011001111111111111100110011"
    "111111111111001100",
    "11001100111111111111111111111111111111111111111111001111111111111100110011"
    "111111111111001100",
    "11001100111111111111111111111111111111111111111111001111111111111110110011"
    "111111111111001100",
    "11001100111111111111111111111111111111111111111111001111111111111111110011"
    "111111111111001100",
    "11001100111111111111111111111111111111111111111111001111111111111111111011"
    "111111111111001100",
    "11001100111111111111111111111111111111111111111111001111111111111111111111"
    "111111111111001100",
    "11001100111111111111111111111111111111111111111111001111111111111111111111"
    "111111111111101100",
    "11001100111111111111111111111111111111111111111111001111111111111111111111"
    "111111111111111100",
    "11001100111111111111111111111111111111111111111111001111111111111111111111"
    "111111111111111110",
    "11001100111111111111111111111111111111111111111111001111111111111111111111"
    "111111111111111111",
    "11001110111111111111111111111111111111111111111110001000110011111111111111"
    "11111111111111111111111111",
    "11001110111111111111111111111111111111111111111110001100110011111111111111"
    "11111111111111111111111111",
    "11001110111111111111111111111111111111111111111111001100100011001111111111"
    "111111111111111111111111111111",
    "11001110111111111111111111111111111111111111111111001100110011001111111111"
    "111111111111111111111111111111",
    "11001111111111111111111111111111111111111111111111001100110010001000110011"
    "11111111111111111111111111111111111111",
    "11001111111111111111111111111111111111111111111111001100110010001100110011"
    "11111111111111111111111111111111111111",
    "11001111111111111111111111111111111111111111111111001100110011001100100011"
    "001111111111111111111111111111111111111111",
    "11001111111111111111111111111111111111111111111111001100110011001100110011"
    "001111111111111111111111111111111111111111",
    "11001111111111111111111111111111111111111111111111001100110011001100110011"
    "10111111111111111111111111111111111111111110001000",
    "11001111111111111111111111111111111111111111111111001100110011001100110011"
    "10111111111111111111111111111111111111111110001100",
    "11001111111111111111111111111111111111111111111111001100110011001100110011"
    "101111111111111111111111111111111111111111110011001000",
    "11001111111111111111111111111111111111111111111111001100110011001100110011"
    "101111111111111111111111111111111111111111110011001100",
    "11001111111111111111111111111111111111111111111111001100110011001100110011"
    "11111111111111111111111111111111111111111111001100110010001000",
    "11001111111111111111111111111111111111111111111111001100110011001100110011"
    "11111111111111111111111111111111111111111111001100110010001100",
    "11001111111111111111111111111111111111111111111111001100110011001100110011"
    "111111111111111111111111111111111111111111110011001100110011001000",
    "11001111111111111111111111111111111111111111111111001100110011001100110011"
    "111111111111111111111111111111111111111111110011001100110011001100",
    "11001111111111111111111111111111111111111111111111001110110011001100110011"
    "111111111111111111111111111111111111111111110011001100110011001100",
    "11001111111111111111111111111111111111111111111111001111110011001100110011"
    "111111111111111111111111111111111111111111110011001100110011001100",
    "11001111111111111111111111111111111111111111111111001111111011001100110011"
    "111111111111111111111111111111111111111111110011001100110011001100",
    "11001111111111111111111111111111111111111111111111001111111111001100110011"
    "111111111111111111111111111111111111111111110011001100110011001100",
    "11001111111111111111111111111111111111111111111111001111111111001110110011"
    "111111111111111111111111111111111111111111110011001100110011001100",
    "11001111111111111111111111111111111111111111111111001111111111001111110011"
    "111111111111111111111111111111111111111111110011001100110011001100",
    "11001111111111111111111111111111111111111111111111001111111111001111111011"
    "111111111111111111111111111111111111111111110011001100110011001100",
    "11001111111111111111111111111111111111111111111111001111111111001111111111"
    "111111111111111111111111111111111111111111110011001100110011001100",
    "11001111111111111111111111111111111111111111111111001111111111001111111111"
    "111111111111111111111111111111111111111111110011101100110011001100",
    "11001111111111111111111111111111111111111111111111001111111111001111111111"
    "111111111111111111111111111111111111111111110011111100110011001100",
    "11001111111111111111111111111111111111111111111111001111111111001111111111"
    "111111111111111111111111111111111111111111110011111110110011001100",
    "11001111111111111111111111111111111111111111111111001111111111001111111111"
    "111111111111111111111111111111111111111111110011111111110011001100",
    "11001111111111111111111111111111111111111111111111001111111111001111111111"
    "111111111111111111111111111111111111111111110011111111110011101100",
    "11001111111111111111111111111111111111111111111111001111111111001111111111"
    "111111111111111111111111111111111111111111110011111111110011111100",
    "11001111111111111111111111111111111111111111111111001111111111001111111111"
    "111111111111111111111111111111111111111111110011111111110011111110",
    "11001111111111111111111111111111111111111111111111001111111111001111111111"
    "111111111111111111111111111111111111111111110011111111110011111111",
    "11001111111111111111111111111111111111111111111111101111111110001100111111"
    "1111111111111111111111111111111111111111111111110011111111110011111111",
    "11001111111111111111111111111111111111111111111111101111111111001100111111"
    "1111111111111111111111111111111111111111111111110011111111110011111111",
    "11001111111111111111111111111111111111111111111111111111111111001000110011"
    "1111111111111111111111111111111111111111111111111111001111111111001111111"
    "1",
    "11001111111111111111111111111111111111111111111111111111111111001100110011"
    "1111111111111111111111111111111111111111111111111111001111111111001111111"
    "1",
    "11001111111111111111111111111111111111111111111111111111111111001100111011"
    "11111110001111111111111111111111111111111111111111111111001111111111001111"
    "1111",
    "11001111111111111111111111111111111111111111111111111111111111001100111011"
    "11111111001111111111111111111111111111111111111111111111001111111111001111"
    "1111",
    "11001111111111111111111111111111111111111111111111111111111111001100111111"
    "11111111001000111111111111111111111111111111111111111111111100111111111100"
    "11111111",
    "11001111111111111111111111111111111111111111111111111111111111001100111111"
    "11111111001100111111111111111111111111111111111111111111111100111111111100"
    "11111111",
    "11001111111111111111111111111111111111111111111111111111111111001100111111"
    "11111111001100111111111111111111111111111111111111111111111110111111111000"
    "110011111111",
    "11001111111111111111111111111111111111111111111111111111111111001100111111"
    "11111111001100111111111111111111111111111111111111111111111110111111111100"
    "110011111111",
    "11001111111111111111111111111111111111111111111111111111111111001100111111"
    "11111111001100111111111111111111111111111111111111111111111111111111111100"
    "1000110011111111",
    "11001111111111111111111111111111111111111111111111111111111111001100111111"
    "11111111001100111111111111111111111111111111111111111111111111111111111100"
    "1100110011111111",
    "11001111111111111111111111111111111111111111111111111111111111001100111111"
    "11111111001100111111111111111111111111111111111111111111111111111111111100"
    "11001110111111111000",
    "11001111111111111111111111111111111111111111111111111111111111001100111111"
    "11111111001100111111111111111111111111111111111111111111111111111111111100"
    "11001110111111111100",
    "11001111111111111111111111111111111111111111111111111111111111001100111111"
    "11111111001100111111111111111111111111111111111111111111111111111111111100"
    "110011111111111111001000",
    "11001111111111111111111111111111111111111111111111111111111111001100111111"
    "11111111001100111111111111111111111111111111111111111111111111111111111100"
    "110011111111111111001100",
    "11001111111111111111111111111111111111111111111111111111111111101100111111"
    "11111111001100111111111111111111111111111111111111111111111111111111111100"
    "110011111111111111001100",
    "11001111111111111111111111111111111111111111111111111111111111111100111111"
    "11111111001100111111111111111111111111111111111111111111111111111111111100"
    "110011111111111111001100",
    "11001111111111111111111111111111111111111111111111111111111111111110111111"
    "11111111001100111111111111111111111111111111111111111111111111111111111100"
    "110011111111111111001100",
    "11001111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111001100111111111111111111111111111111111111111111111111111111111100"
    "110011111111111111001100",
    "11001111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111101100111111111111111111111111111111111111111111111111111111111100"
    "110011111111111111001100",
    "11001111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111100111111111111111111111111111111111111111111111111111111111100"
    "110011111111111111001100",
    "11001111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111110111111111111111111111111111111111111111111111111111111111100"
    "110011111111111111001100",
    "11001111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111100"
    "110011111111111111001100",
    "11001111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111110"
    "110011111111111111001100",
    "11001111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "110011111111111111001100",
    "11001111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "111011111111111111001100",
    "11001111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "111111111111111111001100",
    "11001111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "111111111111111111101100",
    "11001111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "111111111111111111111100",
    "11001111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "111111111111111111111110",
    "11001111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "111111111111111111111111",
    "11101111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "111111111111111111111111100010001000",
    "11101111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "111111111111111111111111100010001100",
    "11101111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "1111111111111111111111111000110011001000",
    "11101111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "1111111111111111111111111000110011001100",
    "11101111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "111111111111111111111111110011001100110010001000",
    "11101111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "111111111111111111111111110011001100110010001100",
    "11101111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "1111111111111111111111111100110011001100110011001000",
    "11101111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "1111111111111111111111111100110011001100110011001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "1111111111111111111111111100110011001100110011001100100010001000",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "1111111111111111111111111100110011001100110011001100100010001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001100110011001100110011001000110011001000",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001100110011001100110011001000110011001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001100110011001100110011001100110011001100100010"
    "00",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001100110011001100110011001100110011001100100011"
    "00",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001100110011001100110011001100110011001100110011"
    "001000",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001100110011001100110011001100110011001100110011"
    "001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001100111011001100110011001100110011001100110011"
    "001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001100111111001100110011001100110011001100110011"
    "001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001100111111101100110011001100110011001100110011"
    "001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001100111111111100110011001100110011001100110011"
    "001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001100111111111100111011001100110011001100110011"
    "001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001100111111111100111111001100110011001100110011"
    "001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001100111111111100111111101100110011001100110011"
    "001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001100111111111100111111111100110011001100110011"
    "001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001100111111111100111111111100110011101100110011"
    "001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001100111111111100111111111100110011111100110011"
    "001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001100111111111100111111111100110011111110110011"
    "001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001100111111111100111111111100110011111111110011"
    "001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001100111111111100111111111100110011111111110011"
    "101100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001100111111111100111111111100110011111111110011"
    "111100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001100111111111100111111111100110011111111110011"
    "111110",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001100111111111100111111111100110011111111110011"
    "111111",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001110111111111000110011111111110011001111111111"
    "0011111111",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001110111111111100110011111111110011001111111111"
    "0011111111",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001111111111111100100011001111111111001100111111"
    "11110011111111",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001111111111111100110011001111111111001100111111"
    "11110011111111",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001111111111111100110011101111111110001100110011"
    "111111110011111111",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001111111111111100110011101111111111001100110011"
    "111111110011111111",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001111111111111100110011111111111111001000110011"
    "0011111111110011111111",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001111111111111100110011111111111111001100110011"
    "0011111111110011111111",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001111111111111100110011111111111111001100110011"
    "10111111111000110011111111",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001111111111111100110011111111111111001100110011"
    "10111111111100110011111111",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001111111111111100110011111111111111001100110011"
    "111111111111001000110011111111",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001111111111111100110011111111111111001100110011"
    "111111111111001100110011111111",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001111111111111100110011111111111111001100110011"
    "1111111111110011001110111111111000",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001111111111111100110011111111111111001100110011"
    "1111111111110011001110111111111100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001111111111111100110011111111111111001100110011"
    "11111111111100110011111111111111001000",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001111111111111100110011111111111111001100110011"
    "11111111111100110011111111111111001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001111111111111110110011111111111111001100110011"
    "11111111111100110011111111111111001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001111111111111111110011111111111111001100110011"
    "11111111111100110011111111111111001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001111111111111111111011111111111111001100110011"
    "11111111111100110011111111111111001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001111111111111111111111111111111111001100110011"
    "11111111111100110011111111111111001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001111111111111111111111111111111111101100110011"
    "11111111111100110011111111111111001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001111111111111111111111111111111111111100110011"
    "11111111111100110011111111111111001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001111111111111111111111111111111111111110110011"
    "11111111111100110011111111111111001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001111111111111111111111111111111111111111110011"
    "11111111111100110011111111111111001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001111111111111111111111111111111111111111110011"
    "11111111111110110011111111111111001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001111111111111111111111111111111111111111110011"
    "11111111111111110011111111111111001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001111111111111111111111111111111111111111110011"
    "11111111111111111011111111111111001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001111111111111111111111111111111111111111110011"
    "11111111111111111111111111111111001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001111111111111111111111111111111111111111110011"
    "11111111111111111111111111111111101100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001111111111111111111111111111111111111111110011"
    "11111111111111111111111111111111111100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001111111111111111111111111111111111111111110011"
    "11111111111111111111111111111111111110",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111001111111111111111111111111111111111111111110011"
    "11111111111111111111111111111111111111",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111101111111111111111111111111111111111111111100010"
    "0011001111111111111111111111111111111111111111",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111101111111111111111111111111111111111111111100011"
    "0011001111111111111111111111111111111111111111",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111101111111111111111111111111111111111111111110011"
    "00100011001111111111111111111111111111111111111111",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111101111111111111111111111111111111111111111110011"
    "00110011001111111111111111111111111111111111111111",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111110011"
    "0011001000100011001111111111111111111111111111111111111111",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111110011"
    "0011001000110011001111111111111111111111111111111111111111",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111110011"
    "00110011001100100011001111111111111111111111111111111111111111",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111110011"
    "00110011001100110011001111111111111111111111111111111111111111",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111110011"
    "0011001100110011001110111111111111111111111111111111111111111110001000",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111110011"
    "0011001100110011001110111111111111111111111111111111111111111110001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111110011"
    "0011001100110011001110111111111111111111111111111111111111111111001100100"
    "0",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111110011"
    "0011001100110011001110111111111111111111111111111111111111111111001100110"
    "0",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111110011"
    "00110011001100110011111111111111111111111111111111111111111111110011001100"
    "10001000",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111110011"
    "00110011001100110011111111111111111111111111111111111111111111110011001100"
    "10001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111110011"
    "00110011001100110011111111111111111111111111111111111111111111110011001100"
    "110011001000",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111110011"
    "00110011001100110011111111111111111111111111111111111111111111110011001100"
    "110011001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111110011"
    "10110011001100110011111111111111111111111111111111111111111111110011001100"
    "110011001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111110011"
    "11110011001100110011111111111111111111111111111111111111111111110011001100"
    "110011001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111110011"
    "11111011001100110011111111111111111111111111111111111111111111110011001100"
    "110011001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111110011"
    "11111111001100110011111111111111111111111111111111111111111111110011001100"
    "110011001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111110011"
    "11111111001110110011111111111111111111111111111111111111111111110011001100"
    "110011001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111110011"
    "11111111001111110011111111111111111111111111111111111111111111110011001100"
    "110011001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111110011"
    "11111111001111111011111111111111111111111111111111111111111111110011001100"
    "110011001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111110011"
    "11111111001111111111111111111111111111111111111111111111111111110011001100"
    "110011001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111110011"
    "11111111001111111111111111111111111111111111111111111111111111110011101100"
    "110011001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111110011"
    "11111111001111111111111111111111111111111111111111111111111111110011111100"
    "110011001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111110011"
    "11111111001111111111111111111111111111111111111111111111111111110011111110"
    "110011001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111110011"
    "11111111001111111111111111111111111111111111111111111111111111110011111111"
    "110011001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111110011"
    "11111111001111111111111111111111111111111111111111111111111111110011111111"
    "110011101100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111110011"
    "11111111001111111111111111111111111111111111111111111111111111110011111111"
    "110011111100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111110011"
    "11111111001111111111111111111111111111111111111111111111111111110011111111"
    "110011111110",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111110011"
    "11111111001111111111111111111111111111111111111111111111111111110011111111"
    "110011111111",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111011"
    "11111110001100111111111111111111111111111111111111111111111111111111001111"
    "1111110011111111",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111011"
    "11111111001100111111111111111111111111111111111111111111111111111111001111"
    "1111110011111111",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111001000110011111111111111111111111111111111111111111111111111111100"
    "11111111110011111111",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111001100110011111111111111111111111111111111111111111111111111111100"
    "11111111110011111111",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111001100111011111111100011111111111111111111111111111111111111111111"
    "110011111111110011111111",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111001100111011111111110011111111111111111111111111111111111111111111"
    "110011111111110011111111",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111001100111111111111110010001111111111111111111111111111111111111111"
    "1111110011111111110011111111",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111001100111111111111110011001111111111111111111111111111111111111111"
    "1111110011111111110011111111",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111001100111111111111110011001111111111111111111111111111111111111111"
    "11111110111111111000110011111111",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111001100111111111111110011001111111111111111111111111111111111111111"
    "11111110111111111100110011111111",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111001100111111111111110011001111111111111111111111111111111111111111"
    "111111111111111111001000110011111111",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111001100111111111111110011001111111111111111111111111111111111111111"
    "111111111111111111001100110011111111",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111001100111111111111110011001111111111111111111111111111111111111111"
    "1111111111111111110011001110111111111000",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111001100111111111111110011001111111111111111111111111111111111111111"
    "1111111111111111110011001110111111111100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111001100111111111111110011001111111111111111111111111111111111111111"
    "11111111111111111100110011111111111111001000",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111001100111111111111110011001111111111111111111111111111111111111111"
    "11111111111111111100110011111111111111001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111101100111111111111110011001111111111111111111111111111111111111111"
    "11111111111111111100110011111111111111001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111100111111111111110011001111111111111111111111111111111111111111"
    "11111111111111111100110011111111111111001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111110111111111111110011001111111111111111111111111111111111111111"
    "11111111111111111100110011111111111111001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111110011001111111111111111111111111111111111111111"
    "11111111111111111100110011111111111111001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111011001111111111111111111111111111111111111111"
    "11111111111111111100110011111111111111001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111001111111111111111111111111111111111111111"
    "11111111111111111100110011111111111111001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111101111111111111111111111111111111111111111"
    "11111111111111111100110011111111111111001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111100110011111111111111001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111110110011111111111111001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111110011111111111111001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111011111111111111001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111001100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111101100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111100",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111110",
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111111111111111111111111111111111"
    "11111111111111111111111111111111111111111111",
};

/*
TEST(block_test, fills_till_depth_4_match) {
  uint32_t treedepth = 4;
  unsigned long side = 1 << treedepth;
  BlockWrapper b(treedepth);

  for (unsigned long col = 0; col < side; col++) {
    for (unsigned long row = 0; row < side; row++) {
      int i = col * side + row % side;
      b.insert(col, row);
      ASSERT_EQ(comp_d6[i], b.getStringRep())
          << "failing at col=" << col << ", row=" << row;
    }
  }
  ASSERT_EQ(debug_validate_block_rec(b.b), 0);
}*/

TEST(block_test, diagonal_test_depth4_1) {
  uint32_t treedepth = 4;
  unsigned long side = 1 << treedepth;
  BlockWrapper b(treedepth, 16);
  for (unsigned long i = 0; i < side; i++) {
    b.insert(i, i);
    for (unsigned long col = 0; col < side; col++) {
      for (unsigned long row = 0; row < side; row++) {
        if ((col == row && col > i) || col != row) {
          ASSERT_FALSE(b.has(col, row));
        } else {
          ASSERT_TRUE(b.has(col, row));
        }
      }
    }
  }
  ASSERT_EQ(debug_validate_block_rec(b.b), 0);
}

TEST(block_test, fills_till_depth_6_fail_known_1) {
  uint32_t treedepth = 4;
  unsigned long side = 1 << treedepth;
  BlockWrapper b(treedepth, 8);

  for (unsigned long col = 0; col < side; col++) {
    for (unsigned long row = 0; row < side; row++) {
      if (col == 0 && row == 12) {
        // std::cout << "before" << std::endl;
        // b.printSubBlocks();
      }
      b.insert(col, row);
      if (col == 0 && row == 12) {
        // std::cout << "after" << std::endl;
        // b.printSubBlocks();
      }
      for (unsigned long col_check = 0; col_check < col; col_check++) {
        for (unsigned long row_check = 0; row_check < row; row_check++) {
          ASSERT_TRUE(b.has(col_check, row_check))
              << "(depth = " << treedepth << ") at (" << col << ", " << row
              << ") Must have point " << col_check << ", " << row_check;
        }
      }
      for (unsigned long row_check = 0; row_check <= row; row_check++) {
        ASSERT_TRUE(b.has(col, row_check))
            << "(depth = " << treedepth << ") at (" << col << ", " << row
            << ") Must have point " << col << ", " << row_check;
      }
      for (unsigned long row_check = row + 1; row_check < side; row_check++) {
        ASSERT_FALSE(b.has(col, row_check))
            << "(depth = " << treedepth << ") at (" << col << ", " << row
            << ") Must not have point " << col << ", " << row_check;
      }
      for (unsigned long col_check = col + 1; col_check < side; col_check++) {
        for (unsigned long row_check = 0; row_check < side; row_check++) {
          ASSERT_FALSE(b.has(col_check, row_check))
              << "(depth = " << treedepth << ") at (" << col << ", " << row
              << ") Must not have point " << col_check << ", " << row_check;
        }
      }
    }
  }
  ASSERT_EQ(debug_validate_block_rec(b.b), 0);
}

TEST(block_test, fills_till_depth_6) {
  // return; // Takes too long
  for (uint32_t treedepth = 3; treedepth <= 6; treedepth++) {
    unsigned long side = 1u << treedepth;
    BlockWrapper b(treedepth, 16);

    for (unsigned long col = 0; col < side; col++) {
      for (unsigned long row = 0; row < side; row++) {

        b.insert(col, row);

        for (unsigned long col_check = 0; col_check < col; col_check++) {
          for (unsigned long row_check = 0; row_check < row; row_check++) {
            ASSERT_TRUE(b.has(col_check, row_check))
                << "(depth = " << treedepth << ") at (" << col << ", " << row
                << ") Must have point " << col_check << ", " << row_check;
          }
        }
        for (unsigned long row_check = 0; row_check <= row; row_check++) {
          ASSERT_TRUE(b.has(col, row_check))
              << "(depth = " << treedepth << ") at (" << col << ", " << row
              << ") Must have point " << col << ", " << row_check;
        }
        for (unsigned long row_check = row + 1; row_check < side; row_check++) {
          ASSERT_FALSE(b.has(col, row_check))
              << "(depth = " << treedepth << ") at (" << col << ", " << row
              << ") Must not have point " << col << ", " << row_check;
        }
        for (unsigned long col_check = col + 1; col_check < side; col_check++) {
          for (unsigned long row_check = 0; row_check < side; row_check++) {
            ASSERT_FALSE(b.has(col_check, row_check))
                << "(depth = " << treedepth << ") at (" << col << ", " << row
                << ") Must not have point " << col_check << ", " << row_check;
          }
        }
      }
    }
    for (unsigned long col = 0; col < side; col++) {
      for (unsigned long row = 0; row < side; row++) {
        ASSERT_TRUE(b.has(col, row))
            << "(depth = " << treedepth << ") No point " << col << ", " << row;
      }
    }
    ASSERT_EQ(debug_validate_block_rec(b.b), 0);
  }
}

TEST(block_test, very_deep_1) {
  // return; // Takes too long
  uint32_t treedepth = 10;
  unsigned long side = 1u << treedepth;
  BlockWrapper b(treedepth, 16);

  for (unsigned long col = 0; col < side; col++) {
    for (unsigned long row = 0; row < side; row++) {
      b.insert(col, row);
    }
  }
  for (unsigned long col = 0; col < side; col++) {
    for (unsigned long row = 0; row < side; row++) {
      ASSERT_TRUE(b.has(col, row))
          << "(depth = " << treedepth << ") No point " << col << ", " << row;
    }
  }
  ASSERT_EQ(debug_validate_block_rec(b.b), 0);
}

TEST(block_test, very_deep_diagonal) {
  // return; // Takes too long
  uint32_t treedepth = 20;
  unsigned long side = 1u << treedepth;
  BlockWrapper b(treedepth, 64);

  for (unsigned long i = 0; i < side; i++) {
    b.insert(i, i);
  }
  for (unsigned long i = 0; i < side; i++) {
    ASSERT_TRUE(b.has(i, i))
        << "(depth = " << treedepth << ") No point " << i << ", " << i;
  }
}

TEST(block_test, very_very_deep_1) {
  uint32_t treedepth = 30;
  BlockWrapper b(treedepth, 64);
  for (unsigned long i = 0; i < 10000; i++) {
    b.insert(i, i);
  }
  for (unsigned long i = 0; i < 10000; i++) {
    ASSERT_TRUE(b.has(i, i))
        << "(depth = " << treedepth << ") No point " << i << ", " << i;
  }
  ASSERT_EQ(debug_validate_block_rec(b.b), 0);
}

TEST(block_test, random_test_1) {
  // return; // Takes too long
  for (uint32_t treedepth = 3; treedepth <= 5; treedepth++) {
    for (int seed = 0; seed < 10; seed++) {
      srand(seed);
      unsigned long side = 1u << treedepth;
      unsigned long matrix_size = side * side;
      BlockWrapper b(treedepth, 16);

      std::vector<unsigned long> indexes(matrix_size, 0);

      for (unsigned long i = 0; i < matrix_size; i++)
        indexes[i] = i;

      shuffle(indexes.begin(), indexes.end(), g);

      for (unsigned long i = 0; i < matrix_size; i++) {
        unsigned long col = i / side;
        unsigned long row = i % side;
        b.insert(col, row);
        for (unsigned long j = 0; j < matrix_size; j++) {
          unsigned long col_check = j / side;
          unsigned long row_check = j % side;
          if (j <= i) {
            ASSERT_TRUE(b.has(col_check, row_check))
                << "(depth = " << treedepth << ") after inserting " << col
                << ", " << row << "doesn't have " << col_check << ", "
                << row_check;
          } else {
            ASSERT_FALSE(b.has(col_check, row_check))
                << "(depth = " << treedepth << ") after inserting " << col
                << ", " << row << "has " << col_check << ", " << row_check;
          }
        }
      }
      ASSERT_EQ(debug_validate_block_rec(b.b), 0);
    }
  }
}

TEST(block_test, random_test_2) {
  for (uint32_t treedepth = 3; treedepth <= 6; treedepth++) {
    for (int seed = 0; seed < 100; seed++) {
      srand(seed);
      unsigned long side = 1u << treedepth;
      unsigned long matrix_size = side * side;
      BlockWrapper b(treedepth, 16);

      std::vector<unsigned long> indexes(matrix_size, 0);

      for (unsigned long i = 0; i < matrix_size; i++)
        indexes[i] = i;

      shuffle(indexes.begin(), indexes.end(), g);

      for (unsigned long i = 0; i < matrix_size; i++) {
        unsigned long col = indexes[i];
        unsigned long row = (indexes[i] + matrix_size * 7) % matrix_size;
        b.insert(col, row);
      }
      for (unsigned long i = 0; i < matrix_size; i++) {
        unsigned long col = indexes[i];
        unsigned long row = (indexes[i] + matrix_size * 7) % matrix_size;
        ASSERT_TRUE(b.has(col, row)) << "(depth = " << treedepth << ")"
                                     << "doesn't have " << col << ", " << row
                                     << ". At seed = " << seed << ", i = " << i;
      }
      ASSERT_EQ(debug_validate_block_rec(b.b), 0);
    }
  }
}

TEST(block_test, diag_failing_split) {
  BlockWrapper b(20, 1024);
  for (int i = 0; i < 432; i++) {
    b.insert(i, i);
    int v = debug_validate_block_rec(b.get_root());
    ASSERT_EQ(v, 0);
  }

  b.insert(432, 432);
  int v = debug_validate_block_rec(b.get_root());
  ASSERT_EQ(v, 0);
}

TEST(block_test, diag_failing_split_2) {
  BlockWrapper b(20, 256);
  for (int i = 0; i < 6192; i++) {
    b.insert(i, i);
  }

  b.insert(6192, 6192);
  int v = debug_validate_block_rec(b.get_root());
  ASSERT_EQ(v, 0);
}

TEST(block_test, naive_scan_test_1) {
  BlockWrapper b(32, 256);

  int cols = 300;
  int rows = 300;
  for (int i = 0; i < cols; i++) {
    for (int j = 0; j < rows; j++) {
      b.insert(i, j);
    }
  }

  struct vector_pair2dl_t resulting_pairs;
  vector_pair2dl_t__init_vector_with_capacity(&resulting_pairs, cols * rows);
  naive_scan_points(b.get_root(), b.get_qs(), &resulting_pairs);
  ASSERT_EQ(resulting_pairs.nof_items, cols * rows);
  int count = 0;
  for (int i = 0; i < resulting_pairs.nof_items; i++) {
    pair2dl p = resulting_pairs.data[i];
    ASSERT_TRUE(b.has(p.col, p.row));
    count++;
  }
  ASSERT_EQ(count, cols * rows);

  vector_pair2dl_t__free_vector(&resulting_pairs);
}

TEST(block_test, band_scan_test_1) {
  BlockWrapper b(32, 256);

  int cols = 300;
  int rows = 300;
  for (int i = 0; i < cols; i++) {
    for (int j = 0; j < rows; j++) {
      b.insert(i, j);
    }
  }

  struct vector_pair2dl_t resulting_pairs;
  vector_pair2dl_t__init_vector_with_capacity(&resulting_pairs, cols * rows);
  report_column(b.get_root(), 0, b.get_qs(), &resulting_pairs);
  ASSERT_EQ(resulting_pairs.nof_items, rows);
  int count = 0;
  for (int i = 0; i < resulting_pairs.nof_items; i++) {
    pair2dl p = resulting_pairs.data[i];
    ASSERT_TRUE(b.has(p.col, p.row));
    count++;
  }
  ASSERT_EQ(count, rows);

  vector_pair2dl_t__free_vector(&resulting_pairs);
}
TEST(block_test, band_scan_test_2) {
  BlockWrapper b(32, 256);

  int cols = 300;
  int rows = 300;
  for (int i = 0; i < cols; i++) {
    for (int j = 0; j < rows; j++) {
      b.insert(i, j);
    }
  }

  struct vector_pair2dl_t resulting_pairs;
  vector_pair2dl_t__init_vector_with_capacity(&resulting_pairs, cols * rows);
  report_row(b.get_root(), 0, b.get_qs(), &resulting_pairs);
  ASSERT_EQ(resulting_pairs.nof_items, cols);
  int count = 0;
  for (int i = 0; i < resulting_pairs.nof_items; i++) {
    pair2dl p = resulting_pairs.data[i];
    ASSERT_TRUE(b.has(p.col, p.row));
    count++;
  }
  ASSERT_EQ(count, cols);

  vector_pair2dl_t__free_vector(&resulting_pairs);
}